"""Tool to search for exploits."""

from crewai.tools import BaseTool
from pydantic import BaseModel, Field

from cyber_crew.tools.utils import run_command


class SearchExploitInput(BaseModel):
    """Input schema for SearchExploit."""

    query: str = Field(..., description="The search query for the exploit.")


class SearchExploit(BaseTool):
    """Tool to run a search exploit."""

    name: str = "Search Exploit"
    description: str = "Tool to run a search exploit."
    args_schema: type[BaseModel] = SearchExploitInput

    def _run(self, query: str) -> str:
        cmd = f"searchsploit {query}"
        return run_command(cmd)
